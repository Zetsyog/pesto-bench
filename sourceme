# polybench stuff
if [ -d "polybench/" ]; then
    export POLYBENCH_DIR="$(realpath "polybench/")"
else
    echo "PolyBench directory does not exist. Please run ./fetch_deps.sh to download it."
    return
fi

# pesto stuff

if [ -x "pesto/build/pesto" ]; then
    export PESTO_BIN="$(realpath "./pesto/build/pesto")"
else
    echo "PESTO binary does not exist. Please run ./fetch_deps.sh to build it."
    return
fi

# pluto stuff
if [ -x "pluto/polycc" ]; then
    export PLUTO_BIN="$(realpath "./pluto/polycc")"
    export POLYCC="$PLUTO_BIN"
else
    echo "Pluto binary does not exist. Please run ./fetch_deps.sh to build it."
    return
fi

# find a compiler
if command -v gcc >/dev/null 2>&1; then
    export CC=gcc
elif command -v clang >/dev/null 2>&1; then
    export CC=clang
else
    echo "No suitable C compiler found (gcc or clang). Please install one."
    return
fi

echo "Environment variables set:"
echo "  POLYBENCH_DIR=$POLYBENCH_DIR"
echo "  PESTO_BIN=$PESTO_BIN"
echo "  PLUTO_BIN=$PLUTO_BIN"
echo "  POLYCC=$POLYCC"
echo "You can now run scripts/gen_pesto.sh to generate PESTO-instrumented source files."
